"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{6903:(e,o,t)=>{t.r(o),t.d(o,{default:()=>H});var n=t(5155);t(8413),t(1866),t(3919);var l=t(6756),s=t(833),r=t(5402),i=t(3710),a=t(3314),c=t(7288);let d=[{name:"Varndean School",lng:-.13648267150638296,lat:50.84996246606285,entrances:[{lat:50.848958,lng:-.136222},{lat:50.850123,lng:-.13515}],colour:"red"},{name:"Dorthy Stringer",lng:-.14334912643220177,lat:50.84877028209984,entrances:[{lat:50.849719,lng:-.142787},{lat:50.846838,lng:-.141942}],colour:"blue"},{name:"Hove Park",lng:-.179361,lat:50.840592,entrances:[{lat:50.839065,lng:-.180437},{lat:50.840592,lng:-.178157}],colour:"green"},{name:"Blatchington Mill",lng:-.18379413197832176,lat:50.84494638334588,entrances:[{lat:50.84235,lng:-.183161},{lat:50.845649,lng:-.181637}],colour:"purple"},{name:"Patcham High",lng:-.14338958779814723,lat:50.86270805216661,entrances:[{lat:50.862404,lng:-.142905},{lat:50.863767,lng:-.144205}],colour:"orange"},{name:"Longhill High",lng:-.06719373251716731,lat:50.81838888519547,entrances:[],colour:"yellow"},{name:"BACA",lng:-.09278489104966146,lat:50.85880054711686,entrances:[{lat:50.85806,lng:-.093756},{lat:50.858166,lng:-.087841}],colour:"black"},{name:"PACA",lng:-.22580460499288743,lat:50.85085909379337,entrances:[],colour:"grey"}];var h=t(2115),u=t(8741),p=t.n(u),g=t(5417),x=t(152),m=t(894),y=t(6924),j=t(1451),f=t(6805),v=t(810),b=t(8984),S=t(2282),w=t(2229),A=t(5480),C=t(2111),k=t(507),P=function(e){return e[e.HidePostcodes=0]="HidePostcodes",e[e.ShowPostcodes=1]="ShowPostcodes",e[e.ClosestSchool=2]="ClosestSchool",e[e.SecondClosestSchool=3]="SecondClosestSchool",e[e.ThirdClosestSchool=4]="ThirdClosestSchool",e[e.showDistanceMap=5]="showDistanceMap",e}(P||{});let R=e=>p().divIcon({className:"custom-disk-icon",html:'<div style="background-color: '.concat(e,'; width: 10px; height: 10px; border-radius: 50%;"></div>'),iconSize:[10,10],iconAnchor:[5,5]}),J=async()=>({default:[...await t.e(544).then(t.t.bind(t,8544,19)).then(e=>e.default),...await t.e(933).then(t.t.bind(t,2933,19)).then(e=>e.default)]}).default,H=()=>{var e,o;let[t,u]=(0,h.useState)([]),[p,P]=(0,h.useState)({id:0,startPoint:[0,0],schoolJourneys:[]}),[H,M]=(0,h.useState)(1),[F,z]=(0,h.useState)(!1),[D,L]=(0,h.useState)(""),[T,W]=(0,h.useState)(4);(0,h.useEffect)(()=>{J().then(e=>{u(e.map(e=>({...e,journeys:e.journeys?e.journeys.sort((e,o)=>e.distance-o.distance):[]})))})},[]);let I=e=>{P({...p,schoolJourneys:p.schoolJourneys.map(o=>o.name===e?{...o,renderRoute:!o.renderRoute}:o)})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(g.Ay,{container:!0,spacing:2,style:{height:"100%"},children:[(0,n.jsx)(g.Ay,{item:!0,xs:2,style:{height:"100%"},children:(0,n.jsxs)("div",{style:{backgroundColor:"white",overflowY:"auto",padding:"10px"},children:[(0,n.jsx)("h2",{children:"Colours"}),(0,n.jsx)("ul",{children:d.map(e=>(0,n.jsxs)("li",{style:{color:e.colour},children:[e.name,": ",e.colour]},e.name))}),(0,n.jsx)("h2",{style:{fontWeight:"bold",paddingTop:"10px"},children:"Route Information"}),null===(e=p.schoolJourneys)||void 0===e?void 0:e.map(e=>(0,n.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{style:{fontWeight:"bold",color:e.colour},children:[e.name," - ",e.journeyType]}),(0,n.jsx)("button",{onClick:()=>I(e.name||""),style:{backgroundColor:e.renderRoute?"#f44336":"#4CAF50",color:"white",border:"none",padding:"1px 2px",textAlign:"center",textDecoration:"none",display:"inline-block",fontSize:"10px",margin:"2px 2px",cursor:"pointer",borderRadius:"1px"},children:e.renderRoute?"Hide Route":"Show Route"})]}),(0,n.jsxs)("div",{style:{paddingLeft:"1rem"},children:[e.distance.toFixed(2)," miles"]}),(0,n.jsxs)("div",{style:{paddingLeft:"1rem"},children:[e.duration.toFixed(2)," minutes"]})]},e.name))]})}),(0,n.jsxs)(g.Ay,{item:!0,xs:10,style:{height:"100%"},children:[(0,n.jsx)(j.A,{position:"static",children:(0,n.jsxs)(f.A,{children:[(0,n.jsx)(v.A,{variant:"h6",style:{flexGrow:1}}),(0,n.jsx)(S.A,{color:"inherit",onClick:()=>{M(H?0:1)},children:0!=H?"Hide Postcodes":"Show Postcodes"}),(0,n.jsx)(S.A,{color:"inherit",onClick:()=>{M(2),u([...t])},children:"Closest School"}),(0,n.jsx)(S.A,{color:"inherit",onClick:()=>{M(3),u([...t])},children:"2nd Closest School"}),(0,n.jsx)(S.A,{color:"inherit",onClick:()=>{M(4),u([...t])},children:"3rd Closest School"}),(0,n.jsxs)(C.A,{variant:"outlined",style:{minWidth:120,marginLeft:"10px"},children:[(0,n.jsx)(k.A,{id:"school-select-label",children:"Schools"}),(0,n.jsx)(w.A,{labelId:"school-select-label",id:"school-select",label:"Schools",onChange:e=>{let o=d.find(o=>o.name===e.target.value);L((null==o?void 0:o.name)||""),M(5)},children:d.map(e=>(0,n.jsx)(A.A,{value:e.name,children:e.name},e.name))})]}),(0,n.jsx)(x.A,{label:"Max Distance (miles)",type:"number",value:T,onChange:e=>W(parseFloat(e.target.value)),style:{padding:"2px",marginLeft:"10px",width:"100px"}}),(0,n.jsx)(b.A,{title:"Select the school from the drop down to see the distances to each school, red is the furthest (set in the text box), green is the closest",children:(0,n.jsx)(m.A,{color:"inherit",children:(0,n.jsx)(y.A,{})})})]})}),(0,n.jsxs)(s.W,{id:"map",center:[50.84078,-.14691],zoom:13,scrollWheelZoom:!0,style:{height:"100%",width:"100%",cursor:"crosshair"},children:[(0,n.jsx)(r.e,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),d.map(e=>(0,n.jsx)(i.p,{position:[e.lat,e.lng],children:(0,n.jsx)(a.z,{children:e.name})},e.name)),(0,n.jsx)(()=>((0,l.Po)({click:e=>{if(F){let{lat:o,lng:t}=e.latlng;P({id:0,startPoint:[o,t],schoolJourneys:[]}),(async()=>{let e=await fetch("/api/distances?lat=".concat(o,"&lng=").concat(t));if(e.ok){let n=await e.json();p.schoolJourneys=n.schoolJourneys.map(e=>(e.renderRoute=!0,e)),p.startPoint=[o,t],P(p)}else console.error("Failed to fetch distances:",e.statusText)})()}}}),null),{}),(1==H||2==H||3==H||4==H)&&t.map(e=>{let o="blue";if(H>1&&e.journeys){let t=e.journeys[H-2];o="string"==typeof t.colour?t.colour:"blue"}return(0,n.jsx)(i.p,{position:[e.lat,e.lng],icon:R(o),eventHandlers:{click:()=>{P({id:0,startPoint:[e.lat,e.lng],schoolJourneys:e.journeys?e.journeys.map(e=>({...e,renderRoute:!0,id:0,colour:e.colour||"white"})):[]})}}},e.postcode)}),5==H&&D&&t.map(e=>{var o,t;let l=(e=>{let o=(Math.max(.5,Math.min(T,e))-.5)/(T-.5),t=Math.floor(255*o),n=Math.floor(255*(1-o));return"rgb(".concat(t,",").concat(n,",0)")})((null===(t=e.journeys)||void 0===t?void 0:null===(o=t.find(e=>e.name===D))||void 0===o?void 0:o.distance)||0);return(0,n.jsx)(i.p,{position:[e.lat,e.lng],icon:R(l),eventHandlers:{click:()=>{P({id:0,startPoint:[e.lat,e.lng],schoolJourneys:e.journeys?e.journeys.map(e=>({...e,renderRoute:!0,id:0,colour:e.colour||"white"})):[]})}}},e.postcode)}),null===(o=p.schoolJourneys)||void 0===o?void 0:o.map(e=>e.renderRoute&&(0,n.jsx)(c.R,{positions:e.route,color:e.colour},"p"+e.name))]})]})]})})}}}]);