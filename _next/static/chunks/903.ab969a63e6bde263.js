"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{6903:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var o=n(5155);n(8413),n(1866),n(3919);var l=n(6756),s=n(833),a=n(5402),r=n(3710),c=n(3314),i=n(7288);let d=[{name:"Varndean School",catchment:"StringerVarndean",lng:-.13648267150638296,lat:50.84996246606285,entrances:[{lat:50.848958,lng:-.136222},{lat:50.850123,lng:-.13515}],colour:"red"},{name:"Dorthy Stringer",catchment:"StringerVarndean",lng:-.14334912643220177,lat:50.84877028209984,entrances:[{lat:50.849719,lng:-.142787},{lat:50.846838,lng:-.141942}],colour:"blue"},{name:"Hove Park",catchment:"BlatchingtonHove",lng:-.179361,lat:50.840592,entrances:[{lat:50.839065,lng:-.180437},{lat:50.840592,lng:-.178157}],colour:"green"},{name:"Blatchington Mill",catchment:"BlatchingtonHove",lng:-.18379413197832176,lat:50.84494638334588,entrances:[{lat:50.84235,lng:-.183161},{lat:50.845649,lng:-.181637}],colour:"purple"},{name:"Patcham High",catchment:"PatchamHigh",lng:-.14338958779814723,lat:50.86270805216661,entrances:[{lat:50.862404,lng:-.142905},{lat:50.863767,lng:-.144205}],colour:"orange"},{name:"Longhill High",catchment:"Longhill",lng:-.06719373251716731,lat:50.81838888519547,entrances:[],colour:"yellow"},{name:"BACA",catchment:"BrightonAldridge",lng:-.09278489104966146,lat:50.85880054711686,entrances:[{lat:50.85806,lng:-.093756},{lat:50.858166,lng:-.087841}],colour:"black"},{name:"PACA",catchment:"Portslade",lng:-.22580460499288743,lat:50.85085909379337,entrances:[],colour:"grey"}];var h=n(2115),u=n(8741),m=n.n(u),p=n(5417),g=n(152),x=n(894),j=n(6854),y=n(6924),v=n(1451),f=n(6805),C=n(810),b=n(8984),A=n(2282),w=n(2229),S=n(5480),P=n(2111),k=n(507),R=function(e){return e[e.HidePostcodes=0]="HidePostcodes",e[e.ShowPostcodes=1]="ShowPostcodes",e[e.ClosestSchool=2]="ClosestSchool",e[e.SecondClosestSchool=3]="SecondClosestSchool",e[e.ThirdClosestSchool=4]="ThirdClosestSchool",e[e.showDistanceMap=5]="showDistanceMap",e[e.ClosestPlacedSchool=6]="ClosestPlacedSchool",e}(R||{}),H=function(e){return e[e.HideCatchments=0]="HideCatchments",e[e.OldCatchments=1]="OldCatchments",e[e.NewCatchments=2]="NewCatchments",e}(H||{});let B=e=>m().divIcon({className:"custom-disk-icon",html:'<div style="background-color: '.concat(e,'; width: 10px; height: 10px; border-radius: 50%;"></div>'),iconSize:[10,10],iconAnchor:[5,5]}),J=async()=>({default:[...await n.e(544).then(n.t.bind(n,8544,19)).then(e=>e.default),...await n.e(933).then(n.t.bind(n,2933,19)).then(e=>e.default)]}).default,M=async()=>{let e=await n.e(88).then(n.t.bind(n,6088,19)).then(e=>e.default);return{old:{catchments:(await n.e(649).then(n.t.bind(n,9649,19)).then(e=>e.default)).catchments},new:{catchments:e.catchments}}},I=()=>{var e,t;let[n,u]=(0,h.useState)([]),[m,R]=(0,h.useState)({old:{catchments:[]},new:{catchments:[]}}),[H,I]=(0,h.useState)({id:0,startPoint:[0,0],schoolJourneys:[]}),[L,z]=(0,h.useState)(1),[F,N]=(0,h.useState)(2),[O,T]=(0,h.useState)(!1),[W,D]=(0,h.useState)(""),[_,E]=(0,h.useState)(4),[V,G]=(0,h.useState)(!0);(0,h.useEffect)(()=>{J().then(e=>{u(e.map(e=>({...e,journeys:e.journeys?e.journeys.sort((e,t)=>e.distance-t.distance):[]}))),G(!1)}),M().then(e=>{R(e)})},[]);let Y=e=>{I({...H,schoolJourneys:H.schoolJourneys.map(t=>t.name===e?{...t,renderRoute:!t.renderRoute}:t)})},Z=e=>{let t=(Math.max(.5,Math.min(_,e))-.5)/(_-.5),n=Math.floor(255*t),o=Math.floor(255*(1-t));return"rgb(".concat(n,",").concat(o,",0)")};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(p.Ay,{container:!0,spacing:2,style:{height:"100%"},children:[(0,o.jsx)(p.Ay,{item:!0,xs:2,style:{height:"100%"},children:(0,o.jsxs)("div",{style:{backgroundColor:"white",overflowY:"auto",padding:"10px"},children:[(0,o.jsx)("h2",{children:"Colours"}),(0,o.jsx)("ul",{children:d.map(e=>(0,o.jsxs)("li",{style:{color:e.colour},children:[e.name,": ",e.colour]},e.name))}),(0,o.jsx)("h2",{style:{fontWeight:"bold",paddingTop:"10px"},children:"Route Information"}),null===(e=H.schoolJourneys)||void 0===e?void 0:e.map(e=>(0,o.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)("div",{style:{fontWeight:"bold",color:e.colour},children:[e.name," - ",e.journeyType]}),(0,o.jsx)("button",{onClick:()=>Y(e.name||""),style:{backgroundColor:e.renderRoute?"#f44336":"#4CAF50",color:"white",border:"none",padding:"1px 2px",textAlign:"center",textDecoration:"none",display:"inline-block",fontSize:"10px",margin:"2px 2px",cursor:"pointer",borderRadius:"1px"},children:e.renderRoute?"Hide Route":"Show Route"})]}),(0,o.jsxs)("div",{style:{paddingLeft:"1rem"},children:[e.distance.toFixed(2)," miles"]}),(0,o.jsxs)("div",{style:{paddingLeft:"1rem"},children:[e.duration.toFixed(2)," minutes"]})]},e.name))]})}),(0,o.jsxs)(p.Ay,{item:!0,xs:10,style:{height:"100%"},children:[(0,o.jsx)(v.A,{position:"static",children:(0,o.jsxs)(f.A,{style:{paddingTop:"10px",paddingBottom:"10px",alignItems:"center",justifyContent:"flex-start",gap:"10px"},children:[(0,o.jsx)(C.A,{variant:"h6",style:{flexGrow:0}}),(0,o.jsxs)(P.A,{variant:"outlined",children:[(0,o.jsx)(k.A,{id:"catchment-select-label",children:"Catchment Boundaries"}),(0,o.jsxs)(w.A,{labelId:"catchment-select-label",id:"catchment-select",value:F,onChange:e=>N(e.target.value),label:"Catchment Boundaries",children:[(0,o.jsx)(S.A,{value:0,children:"Hide Catchments"}),(0,o.jsx)(S.A,{value:1,children:"Old Catchments"}),(0,o.jsx)(S.A,{value:2,children:"New Catchments"})]})]}),(0,o.jsx)(A.A,{color:"inherit",onClick:()=>{z(L?0:1)},children:0!=L?"Hide Postcodes":"Show Postcodes"}),(0,o.jsxs)(P.A,{variant:"outlined",style:{minWidth:200,marginLeft:"10px"},children:[(0,o.jsx)(k.A,{id:"render-options-select-label",children:"Render Options"}),(0,o.jsxs)(w.A,{labelId:"render-options-select-label",id:"render-options-select",value:L,onChange:e=>{z(e.target.value),u([...n])},label:"Render Options",children:[(0,o.jsx)(S.A,{value:2,children:"Closest School"}),(0,o.jsx)(S.A,{value:3,children:"2nd Closest School"}),(0,o.jsx)(S.A,{value:4,children:"3rd Closest School"}),(0,o.jsx)(S.A,{value:6,children:"Closest Placed School"})]})]}),(0,o.jsxs)(P.A,{variant:"outlined",style:{minWidth:120,marginLeft:"10px"},children:[(0,o.jsx)(k.A,{id:"school-select-label",children:"Schools"}),(0,o.jsx)(w.A,{labelId:"school-select-label",id:"school-select",label:"Schools",onChange:e=>{let t=d.find(t=>t.name===e.target.value);D((null==t?void 0:t.name)||""),z(5)},children:d.map(e=>(0,o.jsx)(S.A,{value:e.name,children:e.name},e.name))})]}),(0,o.jsx)(g.A,{label:"Max Distance (miles)",type:"number",value:_,onChange:e=>E(parseFloat(e.target.value)),style:{padding:"2px",marginLeft:"10px",width:"150px"}}),(0,o.jsx)(b.A,{title:"Select a school from the drop down to see how far each postcode is from that school, anything over the max distance is bright red, bright green is less that 1 mile\\nClosest placed school displays a red dot if you are over max dist from the closest school which the council says will have space, i.e. BACA, PACA or Longhill. Click on a postcode to see the route to the schools",children:(0,o.jsx)(x.A,{color:"inherit",children:(0,o.jsx)(y.A,{})})})]})}),V&&(0,o.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3},children:(0,o.jsx)(j.A,{})}),(0,o.jsxs)(s.W,{id:"map",center:[50.84078,-.14691],zoom:13,scrollWheelZoom:!0,style:{height:"100%",width:"100%",cursor:"crosshair"},children:[(0,o.jsx)(a.e,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),d.map(e=>(0,o.jsx)(r.p,{position:[e.lat,e.lng],children:(0,o.jsx)(c.z,{children:e.name})},e.name)),(0,o.jsx)(()=>((0,l.Po)({click:e=>{if(O){let{lat:t,lng:n}=e.latlng;I({id:0,startPoint:[t,n],schoolJourneys:[]}),(async()=>{let e=await fetch("/api/distances?lat=".concat(t,"&lng=").concat(n));if(e.ok){let o=await e.json();H.schoolJourneys=o.schoolJourneys.map(e=>(e.renderRoute=!0,e)),H.startPoint=[t,n],I(H)}else console.error("Failed to fetch distances:",e.statusText)})()}}}),null),{}),0!=F&&(2==F?m.new.catchments:m.old.catchments).map(e=>(0,o.jsx)(i.R,{positions:e.coordinates,color:"grey"},e.name)),(1==L||2==L||3==L||4==L||6==L)&&n.map(e=>{let t="blue";if(6==L&&e.journeys){if(!(e.journeys.filter(t=>t.name===e.closestPlacement)[0].distance>_))return;t="red"}else if(L>1&&e.journeys){let n=e.journeys[L-2];t="string"==typeof n.colour?n.colour:"blue"}return(0,o.jsx)(r.p,{position:[e.lat,e.lng],icon:B(t),eventHandlers:{click:()=>{I({id:0,startPoint:[e.lat,e.lng],schoolJourneys:e.journeys?e.journeys.map(e=>({...e,renderRoute:!0,id:0,colour:e.colour||"white"})):[]})}}},e.postcode)}),5==L&&W&&n.map(e=>{var t,n;let l=Z((null===(n=e.journeys)||void 0===n?void 0:null===(t=n.find(e=>e.name===W))||void 0===t?void 0:t.distance)||0);return(0,o.jsx)(r.p,{position:[e.lat,e.lng],icon:B(l),eventHandlers:{click:()=>{I({id:0,startPoint:[e.lat,e.lng],schoolJourneys:e.journeys?e.journeys.map(e=>({...e,renderRoute:!0,id:0,colour:e.colour||"white"})):[]})}}},e.postcode)}),null===(t=H.schoolJourneys)||void 0===t?void 0:t.map(e=>e.renderRoute&&(0,o.jsx)(i.R,{positions:e.route,color:e.colour},"p"+e.name))]})]})]})})}}}]);